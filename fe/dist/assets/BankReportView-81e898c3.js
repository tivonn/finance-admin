import{u as se}from"./index.es-21745a3a.js";import{d as G,u as J,K as Q,r as M,k as ie,p as S,w as n,h as W,m as U,i,o as m,b as a,c as N,y as K,F as q,l as ce,j as p,t as c,a as pe,I as w,D as Y,e as b,f as B,q as ue,S as A,N as de,E as ke}from"./index-a9039ce2.js";/* empty css                                                              */const _e=G({__name:"UpsertBankReportModal",props:{upsertBankReport:Object,currentPayCurrency:String,firstLevelClassifyFilters:Array,secondLevelDetailFilters:Array},emits:["closeModal"],setup(L,{emit:e}){const{t:y}=J(),R=L,P=e,d=Q(()=>ce.isEmpty(R.upsertBankReport)),g=M(),s=ie(d.value?{pay_currency:R.currentPayCurrency,bank_report_date:"",bank_in:null,bank_out:null,description:"",first_level_classify:null,second_level_detail:null}:{...R.upsertBankReport}),O=async()=>{var o,l;try{if(await g.value.validateFields(),d.value)try{await W.post("/bank/report",s),U.success(y("upsertBankReportModal.message.createBankReportSuccess")),F(),window.location.reload()}catch(_){switch((l=(o=_==null?void 0:_.response)==null?void 0:o.data)==null?void 0:l.message){case"无权限":{U.error(y("common.message.noAuth"));break}default:U.error(y("upsertBankReportModal.message.createBankReportFailed"))}}}catch{}},T=()=>{F()},F=()=>{P("closeModal")};return(o,l)=>{const _=i("a-date-picker"),f=i("a-form-item"),x=i("a-input-number"),$=i("a-input"),D=i("a-select-option"),V=i("a-select"),h=i("a-form"),I=i("a-modal");return m(),S(I,{class:"upsert-bankReport-modal",visible:!0,title:d.value?o.$t("upsertBankReportModal.info.createBankReport"):o.$t("upsertBankReportModal.info.updateBankReport"),cancelText:o.$t("common.actions.cancel"),okText:o.$t("common.actions.confirm"),onOk:l[6]||(l[6]=()=>O()),onCancel:l[7]||(l[7]=()=>T())},{default:n(()=>[a(h,{ref_key:"formRef",ref:g,model:s,"label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:16}},{default:n(()=>[a(f,{label:o.$t("bankReportView.info.bankReportDate"),name:"bank_report_date",rules:[{required:!0,type:"date",message:o.$t("upsertBankReportModal.message.bankReportDateInvalid")}]},{default:n(()=>[a(_,{value:s.bank_report_date,"onUpdate:value":l[0]||(l[0]=r=>s.bank_report_date=r),placeholder:o.$t("upsertBankReportModal.info.bankReportDatePlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.bankIn"),name:"bank_in",rules:[{required:!0,type:"number",message:o.$t("upsertBankReportModal.message.bankInInvalid")}]},{default:n(()=>[a(x,{value:s.bank_in,"onUpdate:value":l[1]||(l[1]=r=>s.bank_in=r),controls:!1,placeholder:o.$t("upsertBankReportModal.info.bankInPlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.bankOut"),name:"bank_out",rules:[{required:!0,type:"number",message:o.$t("upsertBankReportModal.message.bankOutInvalid")}]},{default:n(()=>[a(x,{value:s.bank_out,"onUpdate:value":l[2]||(l[2]=r=>s.bank_out=r),controls:!1,placeholder:o.$t("upsertBankReportModal.info.bankOutPlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.description"),name:"description",rules:[{required:!1}]},{default:n(()=>[a($,{value:s.description,"onUpdate:value":l[3]||(l[3]=r=>s.description=r),placeholder:o.$t("upsertBankReportModal.info.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(f,{label:o.$t("bankReportView.info.firstLevelClassify"),name:"first_level_classify",rules:[{required:!0,message:o.$t("upsertBankReportModal.message.firstLevelClassifyInvalid")}]},{default:n(()=>[a(V,{value:s.first_level_classify,"onUpdate:value":l[4]||(l[4]=r=>s.first_level_classify=r),placeholder:o.$t("upsertBankReportModal.info.firstLevelClassifyPlaceholder")},{default:n(()=>[(m(!0),N(q,null,K(L.firstLevelClassifyFilters,r=>(m(),S(D,{key:r.value,value:r.value},{default:n(()=>[p(c(r.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.secondLevelDetail"),name:"second_level_detail",rules:[{required:!0,message:o.$t("upsertBankReportModal.message.secondLevelDetailInvalid")}]},{default:n(()=>[a(V,{value:s.second_level_detail,"onUpdate:value":l[5]||(l[5]=r=>s.second_level_detail=r),placeholder:o.$t("upsertBankReportModal.info.secondLevelDetailPlaceholder")},{default:n(()=>[(m(!0),N(q,null,K(L.secondLevelDetailFilters,r=>(m(),S(D,{key:r.value,value:r.value},{default:n(()=>[p(c(r.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["title","cancelText","okText"])}}}),fe={class:"bank-report-view"},ve={class:"bank-report-header"},be={style:{display:"flex"}},me={class:"bank-report-title"},ye={class:"bank-report-type"},Re={class:"bank-report-action"},we={style:{padding:"8px"}},Ce=G({__name:"BankReportView",setup(L){const{t:e}=J();pe();const y=[{text:e("bankReportView.info.firstLevelClassifyFilter.manage_cost"),value:"manage_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.business_cost"),value:"business_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.finance_cost"),value:"finance_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.bonus"),value:"bonus"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_receivable"),value:"cost_receivable"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_payable"),value:"cost_payable"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_receivable"),value:"other_cost_receivable"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_payable"),value:"other_cost_payable"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_allot"),value:"cost_allot"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_real_in"),value:"cost_real_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.short_borrow_cost"),value:"short_borrow_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_in"),value:"other_cost_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_out"),value:"other_cost_out"},{text:e("bankReportView.info.firstLevelClassifyFilter.accrual_in"),value:"accrual_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.bonus_payable"),value:"bonus_payable"}],R=[{text:e("bankReportView.info.secondLevelDetailFilter.work_cost"),value:"work_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.tel_cost"),value:"tel_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.salary_cost"),value:"salary_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.social_security_cost"),value:"social_security_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.rent_cost"),value:"rent_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.packing_cost"),value:"packing_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.royalty_cost"),value:"royalty_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.cash"),value:"cash"},{text:e("bankReportView.info.secondLevelDetailFilter.middle_cost"),value:"middle_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.accrual_cost"),value:"accrual_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.service_cost"),value:"service_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.all_profit_cost"),value:"all_profit_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.accrual_in_cost"),value:"accrual_in_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.bonus"),value:"bonus"},{text:e("bankReportView.info.secondLevelDetailFilter.th_cost"),value:"th_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.freight_cost"),value:"freight_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.cash_pledge"),value:"cash_pledge"},{text:e("bankReportView.info.secondLevelDetailFilter.last_not_pay"),value:"last_not_pay"},{text:e("bankReportView.info.secondLevelDetailFilter.not_allot_profit"),value:"not_allot_profit"},{text:e("bankReportView.info.secondLevelDetailFilter.other"),value:"other"}],P=[{dataIndex:"bank_report_date",key:"bank_report_date",title:e("bankReportView.info.bankReportDate")},{dataIndex:"bank_in",key:"bank_in",title:e("bankReportView.info.bankIn"),customRender:({text:t})=>w(t)},{dataIndex:"bank_out",key:"bank_out",title:e("bankReportView.info.bankOut"),customRender:({text:t})=>w(t)},{dataIndex:"remain",key:"remain",title:e("bankReportView.info.remain"),customRender:({text:t})=>w(t)},{dataIndex:"description",key:"description",title:e("bankReportView.info.description")},{dataIndex:"first_level_classify",key:"first_level_classify",title:e("bankReportView.info.firstLevelClassify"),filters:y},{dataIndex:"second_level_detail",key:"second_level_detail",title:e("bankReportView.info.secondLevelDetail"),filters:R},{dataIndex:"project",key:"project",title:e("bankReportView.info.project")}].concat(Y("bank-pay-currency")==="THB"?[{dataIndex:"exchange_rate",key:"exchange_rate",title:e("bankReportView.info.exchangeRate")},{dataIndex:"rmb_in",key:"rmb_in",title:e("bankReportView.info.rmbIn"),customRender:({text:t})=>w(t)},{dataIndex:"rmb_out",key:"rmb_out",title:e("bankReportView.info.rmbOut"),customRender:({text:t})=>w(t)},{dataIndex:"rmb_remain",key:"rmb_remain",title:e("bankReportView.info.rmbRemain"),customRender:({text:t})=>w(t)}]:[]),d=M(Y("bank-pay-currency")||"CNY"),g=t=>{d.value=t,ke("bank-pay-currency",t),window.location.reload()},s=t=>W.post("/bank/report/get_list",{pay_currency:d.value,...t}),{data:O,run:T,loading:F,current:o,pageSize:l,total:_}=se(s,{pagination:{currentKey:"page_index",pageSizeKey:"page_size",totalKey:"data.count"}}),f=Q(()=>({total:_.value,current:o.value,pageSize:l.value,showSizeChanger:!0})),x=(t,u,C)=>{const z=Object.assign({},u);T({page_index:t.current,page_size:t.pageSize,sortField:C.field,sortOrder:C.order,...z})},$=t=>{t()},D=t=>{t({confirm:!0})},V=M(!1),h=M({}),I=t=>{V.value=t,t||(h.value={})},r=()=>{h.value={},I(!0)},X=async t=>{},Z=()=>{},ee=()=>{},te=()=>{};return(t,u)=>{var j;const C=i("a-radio-button"),z=i("a-radio-group"),v=i("a-button"),ae=i("a-input"),oe=i("a-table");return m(),N(q,null,[b("div",fe,[b("div",ve,[b("div",be,[b("div",me,c(t.$t("route.reports.bankReport")),1),b("div",ye,[a(z,{value:d.value,"onUpdate:value":u[2]||(u[2]=k=>d.value=k)},{default:n(()=>[a(C,{value:"CNY",onClick:u[0]||(u[0]=k=>g("CNY"))},{default:n(()=>[p(c(t.$t("bankReportView.actions.selectCNYBankReport")),1)]),_:1}),a(C,{value:"THB",onClick:u[1]||(u[1]=k=>g("THB"))},{default:n(()=>[p(c(t.$t("bankReportView.actions.selectTHBBankReport")),1)]),_:1})]),_:1},8,["value"])])]),b("div",Re,[a(v,{type:"primary",onClick:r},{default:n(()=>[p(c(t.$t("bankReportView.actions.addBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:Z,disabled:""},{default:n(()=>[p(c(t.$t("bankReportView.actions.downloadBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:X,disabled:""},{default:n(()=>[p(c(t.$t("bankReportView.actions.deleteBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:ee,disabled:""},{default:n(()=>[p(c(t.$t("bankReportView.actions.viewInBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:te,disabled:""},{default:n(()=>[p(c(t.$t("bankReportView.actions.viewOutBankReport")),1)]),_:1})])]),a(oe,{columns:B(P),"row-key":k=>k.id,"data-source":(j=B(O))==null?void 0:j.data.rows,locale:{filterConfirm:t.$t("common.actions.confirm"),filterReset:t.$t("common.actions.reset")},pagination:f.value,loading:B(F),onChange:x},{customFilterIcon:n(({filtered:k})=>[a(B(A),{style:de({color:k?"#108ee9":void 0})},null,8,["style"])]),customFilterDropdown:n(({setSelectedKeys:k,selectedKeys:ne,confirm:E,clearFilters:le,column:re})=>[b("div",we,[a(ae,{placeholder:`${t.$t("common.actions.search")}${re.title}`,value:ne[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:H=>k(H.target.value?[H.target.value]:[]),onPressEnter:()=>$(E)},null,8,["placeholder","value","onChange","onPressEnter"]),a(v,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:()=>$(E)},{icon:n(()=>[a(B(A))]),default:n(()=>[p(" "+c(t.$t("common.actions.search")),1)]),_:2},1032,["onClick"]),a(v,{size:"small",style:{width:"90px"},onClick:()=>D(le)},{default:n(()=>[p(c(t.$t("common.actions.reset")),1)]),_:2},1032,["onClick"])])]),_:1},8,["columns","row-key","data-source","locale","pagination","loading"])]),V.value?(m(),S(_e,{key:0,upsertBankReport:h.value,currentPayCurrency:d.value,firstLevelClassifyFilters:y,secondLevelDetailFilters:R,onCloseModal:u[3]||(u[3]=()=>I(!1))},null,8,["upsertBankReport","currentPayCurrency"])):ue("",!0)],64)}}});export{Ce as default};
