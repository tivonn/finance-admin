import{u as re}from"./index.es-4681eddc.js";import{d as A,u as G,H as J,r as I,k as ie,p as M,w as l,h as Q,m as T,i as s,o as m,b as a,c as U,x as E,F as q,l as se,j as c,t as p,a as pe,C as K,e as b,f as C,q as ce,S as Y,K as ue,D as de}from"./index-1ff907d5.js";/* empty css                                                              */const ke=A({__name:"UpsertBankReportModal",props:{upsertBankReport:Object,currentPayCurrency:String,firstLevelClassifyFilters:Array,secondLevelDetailFilters:Array},emits:["closeModal"],setup(B,{emit:e}){const{t:y}=G(),R=B,S=e,d=J(()=>se.isEmpty(R.upsertBankReport)),w=I(),i=ie(d.value?{pay_currency:R.currentPayCurrency,bank_report_date:"",bank_in:null,bank_out:null,description:"",first_level_classify:null,second_level_detail:null}:{...R.upsertBankReport}),P=async()=>{var o,n;try{if(await w.value.validateFields(),d.value)try{await Q.post("/bank/report",i),T.success(y("upsertBankReportModal.message.createBankReportSuccess")),L(),window.location.reload()}catch(_){switch((n=(o=_==null?void 0:_.response)==null?void 0:o.data)==null?void 0:n.message){case"无权限":{T.error(y("common.message.noAuth"));break}default:T.error(y("upsertBankReportModal.message.createBankReportFailed"))}}}catch{}},O=()=>{L()},L=()=>{S("closeModal")};return(o,n)=>{const _=s("a-date-picker"),f=s("a-form-item"),F=s("a-input-number"),x=s("a-input"),$=s("a-select-option"),g=s("a-select"),V=s("a-form"),D=s("a-modal");return m(),M(D,{class:"upsert-bankReport-modal",visible:!0,title:d.value?o.$t("upsertBankReportModal.info.createBankReport"):o.$t("upsertBankReportModal.info.updateBankReport"),cancelText:o.$t("common.actions.cancel"),okText:o.$t("common.actions.confirm"),onOk:n[6]||(n[6]=()=>P()),onCancel:n[7]||(n[7]=()=>O())},{default:l(()=>[a(V,{ref_key:"formRef",ref:w,model:i,"label-col":{offset:1,span:5},"wrapper-col":{offset:1,span:16}},{default:l(()=>[a(f,{label:o.$t("bankReportView.info.bankReportDate"),name:"bank_report_date",rules:[{required:!0,type:"date",message:o.$t("upsertBankReportModal.message.bankReportDateInvalid")}]},{default:l(()=>[a(_,{value:i.bank_report_date,"onUpdate:value":n[0]||(n[0]=r=>i.bank_report_date=r),placeholder:o.$t("upsertBankReportModal.info.bankReportDatePlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.bankIn"),name:"bank_in",rules:[{required:!0,type:"number",message:o.$t("upsertBankReportModal.message.bankInInvalid")}]},{default:l(()=>[a(F,{value:i.bank_in,"onUpdate:value":n[1]||(n[1]=r=>i.bank_in=r),controls:!1,placeholder:o.$t("upsertBankReportModal.info.bankInPlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.bankOut"),name:"bank_out",rules:[{required:!0,type:"number",message:o.$t("upsertBankReportModal.message.bankOutInvalid")}]},{default:l(()=>[a(F,{value:i.bank_out,"onUpdate:value":n[2]||(n[2]=r=>i.bank_out=r),controls:!1,placeholder:o.$t("upsertBankReportModal.info.bankOutPlaceholder"),style:{width:"100%"}},null,8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.description"),name:"description",rules:[{required:!1}]},{default:l(()=>[a(x,{value:i.description,"onUpdate:value":n[3]||(n[3]=r=>i.description=r),placeholder:o.$t("upsertBankReportModal.info.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(f,{label:o.$t("bankReportView.info.firstLevelClassify"),name:"first_level_classify",rules:[{required:!0,message:o.$t("upsertBankReportModal.message.firstLevelClassifyInvalid")}]},{default:l(()=>[a(g,{value:i.first_level_classify,"onUpdate:value":n[4]||(n[4]=r=>i.first_level_classify=r),placeholder:o.$t("upsertBankReportModal.info.firstLevelClassifyPlaceholder")},{default:l(()=>[(m(!0),U(q,null,E(B.firstLevelClassifyFilters,r=>(m(),M($,{key:r.value,value:r.value},{default:l(()=>[c(p(r.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label","rules"]),a(f,{label:o.$t("bankReportView.info.secondLevelDetail"),name:"second_level_detail",rules:[{required:!0,message:o.$t("upsertBankReportModal.message.secondLevelDetailInvalid")}]},{default:l(()=>[a(g,{value:i.second_level_detail,"onUpdate:value":n[5]||(n[5]=r=>i.second_level_detail=r),placeholder:o.$t("upsertBankReportModal.info.secondLevelDetailPlaceholder")},{default:l(()=>[(m(!0),U(q,null,E(B.secondLevelDetailFilters,r=>(m(),M($,{key:r.value,value:r.value},{default:l(()=>[c(p(r.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label","rules"])]),_:1},8,["model"])]),_:1},8,["title","cancelText","okText"])}}}),_e={class:"bank-report-view"},fe={class:"bank-report-header"},ve={style:{display:"flex"}},be={class:"bank-report-title"},me={class:"bank-report-type"},ye={class:"bank-report-action"},Re={style:{padding:"8px"}},he=A({__name:"BankReportView",setup(B){const{t:e}=G();pe();const y=[{text:e("bankReportView.info.firstLevelClassifyFilter.manage_cost"),value:"manage_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.business_cost"),value:"business_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.finance_cost"),value:"finance_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.bonus"),value:"bonus"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_receivable"),value:"cost_receivable"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_payable"),value:"cost_payable"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_receivable"),value:"other_cost_receivable"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_payable"),value:"other_cost_payable"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_allot"),value:"cost_allot"},{text:e("bankReportView.info.firstLevelClassifyFilter.cost_real_in"),value:"cost_real_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.short_borrow_cost"),value:"short_borrow_cost"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_in"),value:"other_cost_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.other_cost_out"),value:"other_cost_out"},{text:e("bankReportView.info.firstLevelClassifyFilter.accrual_in"),value:"accrual_in"},{text:e("bankReportView.info.firstLevelClassifyFilter.bonus_payable"),value:"bonus_payable"}],R=[{text:e("bankReportView.info.secondLevelDetailFilter.work_cost"),value:"work_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.tel_cost"),value:"tel_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.salary_cost"),value:"salary_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.social_security_cost"),value:"social_security_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.rent_cost"),value:"rent_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.packing_cost"),value:"packing_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.royalty_cost"),value:"royalty_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.cash"),value:"cash"},{text:e("bankReportView.info.secondLevelDetailFilter.middle_cost"),value:"middle_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.accrual_cost"),value:"accrual_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.service_cost"),value:"service_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.all_profit_cost"),value:"all_profit_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.accrual_in_cost"),value:"accrual_in_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.bonus"),value:"bonus"},{text:e("bankReportView.info.secondLevelDetailFilter.th_cost"),value:"th_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.freight_cost"),value:"freight_cost"},{text:e("bankReportView.info.secondLevelDetailFilter.cash_pledge"),value:"cash_pledge"},{text:e("bankReportView.info.secondLevelDetailFilter.last_not_pay"),value:"last_not_pay"},{text:e("bankReportView.info.secondLevelDetailFilter.not_allot_profit"),value:"not_allot_profit"},{text:e("bankReportView.info.secondLevelDetailFilter.other"),value:"other"}],S=[{dataIndex:"bank_report_date",key:"bank_report_date",title:e("bankReportView.info.bankReportDate")},{dataIndex:"bank_in",key:"bank_in",title:e("bankReportView.info.bankIn")},{dataIndex:"bank_out",key:"bank_out",title:e("bankReportView.info.bankOut")},{dataIndex:"remain",key:"remain",title:e("bankReportView.info.remain")},{dataIndex:"description",key:"description",title:e("bankReportView.info.description")},{dataIndex:"first_level_classify",key:"first_level_classify",title:e("bankReportView.info.firstLevelClassify"),filters:y},{dataIndex:"second_level_detail",key:"second_level_detail",title:e("bankReportView.info.secondLevelDetail"),filters:R},{dataIndex:"project",key:"project",title:e("bankReportView.info.project")}].concat(K("bank-pay-currency")==="THB"?[{dataIndex:"exchange_rate",key:"exchange_rate",title:e("bankReportView.info.exchangeRate")},{dataIndex:"rmb_in",key:"rmb_in",title:e("bankReportView.info.rmbIn")},{dataIndex:"rmb_out",key:"rmb_out",title:e("bankReportView.info.rmbOut")},{dataIndex:"rmb_remain",key:"rmb_remain",title:e("bankReportView.info.rmbRemain")}]:[]),d=I(K("bank-pay-currency")||"CNY"),w=t=>{d.value=t,de("bank-pay-currency",t),window.location.reload()},i=t=>Q.post("/bank/report/get_list",{pay_currency:d.value,...t}),{data:P,run:O,loading:L,current:o,pageSize:n,total:_}=re(i,{pagination:{currentKey:"page_index",pageSizeKey:"page_size",totalKey:"data.count"}}),f=J(()=>({total:_.value,current:o.value,pageSize:n.value,showSizeChanger:!0})),F=(t,u,h)=>{const z=Object.assign({},u);O({page_index:t.current,page_size:t.pageSize,sortField:h.field,sortOrder:h.order,...z})},x=t=>{t()},$=t=>{t({confirm:!0})},g=I(!1),V=I({}),D=t=>{g.value=t,t||(V.value={})},r=()=>{V.value={},D(!0)},W=async t=>{},X=()=>{},Z=()=>{},ee=()=>{};return(t,u)=>{var N;const h=s("a-radio-button"),z=s("a-radio-group"),v=s("a-button"),te=s("a-input"),ae=s("a-table");return m(),U(q,null,[b("div",_e,[b("div",fe,[b("div",ve,[b("div",be,p(t.$t("route.reports.bankReport")),1),b("div",me,[a(z,{value:d.value,"onUpdate:value":u[2]||(u[2]=k=>d.value=k)},{default:l(()=>[a(h,{value:"CNY",onClick:u[0]||(u[0]=k=>w("CNY"))},{default:l(()=>[c(p(t.$t("bankReportView.actions.selectCNYBankReport")),1)]),_:1}),a(h,{value:"THB",onClick:u[1]||(u[1]=k=>w("THB"))},{default:l(()=>[c(p(t.$t("bankReportView.actions.selectTHBBankReport")),1)]),_:1})]),_:1},8,["value"])])]),b("div",ye,[a(v,{type:"primary",onClick:r},{default:l(()=>[c(p(t.$t("bankReportView.actions.addBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:X,disabled:""},{default:l(()=>[c(p(t.$t("bankReportView.actions.downloadBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:W,disabled:""},{default:l(()=>[c(p(t.$t("bankReportView.actions.deleteBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:Z,disabled:""},{default:l(()=>[c(p(t.$t("bankReportView.actions.viewInBankReport")),1)]),_:1}),a(v,{type:"primary",style:{"margin-left":"16px"},onClick:ee,disabled:""},{default:l(()=>[c(p(t.$t("bankReportView.actions.viewOutBankReport")),1)]),_:1})])]),a(ae,{columns:C(S),"row-key":k=>k.id,"data-source":(N=C(P))==null?void 0:N.data.rows,locale:{filterConfirm:t.$t("common.actions.confirm"),filterReset:t.$t("common.actions.reset")},pagination:f.value,loading:C(L),onChange:F},{customFilterIcon:l(({filtered:k})=>[a(C(Y),{style:ue({color:k?"#108ee9":void 0})},null,8,["style"])]),customFilterDropdown:l(({setSelectedKeys:k,selectedKeys:oe,confirm:j,clearFilters:le,column:ne})=>[b("div",Re,[a(te,{placeholder:`${t.$t("common.actions.search")}${ne.title}`,value:oe[0],style:{width:"188px","margin-bottom":"8px",display:"block"},onChange:H=>k(H.target.value?[H.target.value]:[]),onPressEnter:()=>x(j)},null,8,["placeholder","value","onChange","onPressEnter"]),a(v,{type:"primary",size:"small",style:{width:"90px","margin-right":"8px"},onClick:()=>x(j)},{icon:l(()=>[a(C(Y))]),default:l(()=>[c(" "+p(t.$t("common.actions.search")),1)]),_:2},1032,["onClick"]),a(v,{size:"small",style:{width:"90px"},onClick:()=>$(le)},{default:l(()=>[c(p(t.$t("common.actions.reset")),1)]),_:2},1032,["onClick"])])]),_:1},8,["columns","row-key","data-source","locale","pagination","loading"])]),g.value?(m(),M(ke,{key:0,upsertBankReport:V.value,currentPayCurrency:d.value,firstLevelClassifyFilters:y,secondLevelDetailFilters:R,onCloseModal:u[3]||(u[3]=()=>D(!1))},null,8,["upsertBankReport","currentPayCurrency"])):ce("",!0)],64)}}});export{he as default};
